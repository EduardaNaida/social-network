{"ast":null,"code":"import { authAPI } from \"../api/api\";\nimport { stopSubmit } from \"redux-form\";\nconst SET_USER_DATA = \"AUTH/SET_USER_DATA\";\nconst initialState = {\n  id: null,\n  email: null,\n  login: null,\n  isAuth: false\n};\nexport const authReducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case SET_USER_DATA:\n      return { ...state,\n        ...action.payload\n      };\n\n    default:\n      return state;\n  }\n};\nexport const setUserData = (id, email, login, isAuth) => ({\n  type: SET_USER_DATA,\n  payload: {\n    id,\n    email,\n    login,\n    isAuth\n  }\n});\nexport const getAuthUserData = () => {\n  return async dispatch => {\n    let response = await authAPI.authMe();\n\n    if (response.data.resultCode === 0) {\n      let {\n        id,\n        email,\n        login\n      } = response.data.data;\n      dispatch(setUserData(id, email, login, true));\n    }\n\n    ;\n  };\n};\nexport const login = (email, password, rememberMe, captcha) => {\n  return async dispatch => {\n    let response = await authAPI.login(email, password, rememberMe, captcha);\n\n    if (response.data.resultCode === 0) {\n      dispatch(getAuthUserData());\n    } else {\n      if (response.data.messages.length > 0) {\n        dispatch(stopSubmit('email', {\n          _error: response.data.messages\n        }));\n      }\n    }\n  };\n};\nexport const logout = () => {\n  return async dispatch => {\n    let response = await authAPI.logout();\n\n    if (response.data.resultCode === 0) {\n      dispatch(setUserData(null, null, null, false));\n    }\n  };\n};","map":{"version":3,"sources":["/Users/eduardanaida/Documents/GitHub/social-network/src/redux/authReducer.ts"],"names":["authAPI","stopSubmit","SET_USER_DATA","initialState","id","email","login","isAuth","authReducer","state","action","type","payload","setUserData","getAuthUserData","dispatch","response","authMe","data","resultCode","password","rememberMe","captcha","messages","length","_error","logout"],"mappings":"AACA,SAAQA,OAAR,QAAsB,YAAtB;AAEA,SAAQC,UAAR,QAAyB,YAAzB;AAKA,MAAMC,aAAa,GAAG,oBAAtB;AASA,MAAMC,YAAY,GAAG;AACnBC,EAAAA,EAAE,EAAE,IADe;AAEnBC,EAAAA,KAAK,EAAE,IAFY;AAGnBC,EAAAA,KAAK,EAAE,IAHY;AAInBC,EAAAA,MAAM,EAAE;AAJW,CAArB;AAQA,OAAO,MAAMC,WAAW,GAAG,YAAsF;AAAA,MAArFC,KAAqF,uEAA/DN,YAA+D;AAAA,MAAjDO,MAAiD;;AAC/G,UAAQA,MAAM,CAACC,IAAf;AACE,SAAKT,aAAL;AACE,aAAO,EACL,GAAGO,KADE;AAEL,WAAGC,MAAM,CAACE;AAFL,OAAP;;AAIF;AACE,aAAOH,KAAP;AAPJ;AASD,CAVM;AAYP,OAAO,MAAMI,WAAW,GAAG,CAACT,EAAD,EAAoBC,KAApB,EAA0CC,KAA1C,EAAgEC,MAAhE,MAAqF;AAC5GI,EAAAA,IAAI,EAAET,aADsG;AAE5GU,EAAAA,OAAO,EAAE;AAACR,IAAAA,EAAD;AAAKC,IAAAA,KAAL;AAAYC,IAAAA,KAAZ;AAAmBC,IAAAA;AAAnB;AAFmG,CAArF,CAApB;AAOP,OAAO,MAAMO,eAAe,GAAG,MAAM;AACnC,SAAO,MAAOC,QAAP,IAA8B;AACnC,QAAIC,QAAQ,GAAG,MAAMhB,OAAO,CAACiB,MAAR,EAArB;;AAEA,QAAID,QAAQ,CAACE,IAAT,CAAcC,UAAd,KAA6B,CAAjC,EAAoC;AAClC,UAAI;AAACf,QAAAA,EAAD;AAAKC,QAAAA,KAAL;AAAYC,QAAAA;AAAZ,UAAqBU,QAAQ,CAACE,IAAT,CAAcA,IAAvC;AACAH,MAAAA,QAAQ,CAACF,WAAW,CAACT,EAAD,EAAKC,KAAL,EAAYC,KAAZ,EAAmB,IAAnB,CAAZ,CAAR;AACD;;AACD;AACD,GARD;AASD,CAVM;AAYP,OAAO,MAAMA,KAAK,GAAG,CAACD,KAAD,EAAgBe,QAAhB,EAAkCC,UAAlC,EAAuDC,OAAvD,KAA4E;AAE/F,SAAO,MAAOP,QAAP,IAAkC;AACvC,QAAIC,QAAQ,GAAG,MAAMhB,OAAO,CAACM,KAAR,CAAcD,KAAd,EAAqBe,QAArB,EAA+BC,UAA/B,EAA2CC,OAA3C,CAArB;;AAEA,QAAIN,QAAQ,CAACE,IAAT,CAAcC,UAAd,KAA6B,CAAjC,EAAoC;AAClCJ,MAAAA,QAAQ,CAACD,eAAe,EAAhB,CAAR;AACD,KAFD,MAEO;AACL,UAAIE,QAAQ,CAACE,IAAT,CAAcK,QAAd,CAAuBC,MAAvB,GAAgC,CAApC,EAAuC;AACrCT,QAAAA,QAAQ,CAACd,UAAU,CAAC,OAAD,EAAU;AAACwB,UAAAA,MAAM,EAAET,QAAQ,CAACE,IAAT,CAAcK;AAAvB,SAAV,CAAX,CAAR;AACD;AACF;AAEF,GAXD;AAYD,CAdM;AAgBP,OAAO,MAAMG,MAAM,GAAG,MAAM;AAC1B,SAAO,MAAOX,QAAP,IAA8B;AACnC,QAAIC,QAAQ,GAAG,MAAMhB,OAAO,CAAC0B,MAAR,EAArB;;AAEA,QAAIV,QAAQ,CAACE,IAAT,CAAcC,UAAd,KAA6B,CAAjC,EAAoC;AAClCJ,MAAAA,QAAQ,CAACF,WAAW,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,EAAmB,KAAnB,CAAZ,CAAR;AACD;AACF,GAND;AAOD,CARM","sourcesContent":["import {Dispatch} from \"redux\";\nimport {authAPI} from \"../api/api\";\nimport {DispatchType} from \"./reduxStore\";\nimport {stopSubmit} from \"redux-form\";\n\nexport type authReducersActionType =\n  | ReturnType<typeof setUserData>\n\nconst SET_USER_DATA = \"AUTH/SET_USER_DATA\";\n\nexport type UserDataType = {\n  id: number | null,\n  email: string | null,\n  login: string | null\n  isAuth: boolean\n}\n\nconst initialState = {\n  id: null,\n  email: null,\n  login: null,\n  isAuth: false\n}\n\n\nexport const authReducer = (state: UserDataType = initialState, action: authReducersActionType): UserDataType => {\n  switch (action.type) {\n    case SET_USER_DATA:\n      return {\n        ...state,\n        ...action.payload\n      }\n    default:\n      return state;\n  }\n};\n\nexport const setUserData = (id: number | null, email: string | null, login: string | null, isAuth: boolean) => ({\n    type: SET_USER_DATA,\n    payload: {id, email, login, isAuth}\n  } as const\n)\n\n\nexport const getAuthUserData = () => {\n  return async (dispatch: Dispatch) => {\n    let response = await authAPI.authMe()\n\n    if (response.data.resultCode === 0) {\n      let {id, email, login} = response.data.data;\n      dispatch(setUserData(id, email, login, true))\n    }\n    ;\n  }\n}\n\nexport const login = (email: string, password: string, rememberMe: boolean, captcha: boolean) => {\n\n  return async (dispatch: DispatchType) => {\n    let response = await authAPI.login(email, password, rememberMe, captcha)\n\n    if (response.data.resultCode === 0) {\n      dispatch(getAuthUserData())\n    } else {\n      if (response.data.messages.length > 0) {\n        dispatch(stopSubmit('email', {_error: response.data.messages}));\n      }\n    }\n\n  }\n}\n\nexport const logout = () => {\n  return async (dispatch: Dispatch) => {\n    let response = await authAPI.logout()\n\n    if (response.data.resultCode === 0) {\n      dispatch(setUserData(null, null, null, false))\n    }\n  }\n}"]},"metadata":{},"sourceType":"module"}